# Cogito_Backend
README.txt

=========================
API Документация (Backend на Spring Boot)
=========================

Описание сервисов для работы с Пользователями, Рейтингами и их связями (UserRating).

---

1. Общие сведения

- Все эндпоинты начинаются с префикса /api
- Валидация входных параметров: ID должны быть положительными числами (@Positive)
- Валидация DTO происходит с помощью аннотаций (@Valid, @NotBlank, @Size, @Past)
- При ошибках валидации возвращается HTTP 400 с описанием
- При отсутствии сущностей — HTTP 404
- При конфликтных состояниях — HTTP 409
- При успешных операциях — HTTP 200 (OK)

---

2. API Пользователей (Users)

GET /api/users
- Описание: Получить список всех пользователей
- Вход: нет
- Выход: JSON-массив UserDto
- Особенности: если пользователей нет — возвращает 404

GET /api/users/{id}
- Описание: Получить пользователя по ID
- Вход: id (Long, >0)
- Выход: UserDto
- Ошибки: 404 если пользователь не найден

POST /api/users
- Описание: Создать нового пользователя
- Вход: JSON UserDto (без id)
- Выход: Созданный UserDto с id
- Ошибки: 400 при ошибках валидации

PATCH /api/users
- Описание: Обновить данные пользователя
- Вход: JSON UserDto (с id)
- Выход: Обновлённый UserDto
- Ошибки: 404 если пользователь не найден

DELETE /api/users/{id}
- Описание: Удалить пользователя по ID
- Вход: id (Long, >0)
- Выход: пустой ответ 200 OK
- Ошибки: 404 если пользователь не найден

---

3. API Рейтингов (Ratings)

GET /api/ratings
- Описание: Получить список всех рейтингов
- Вход: нет
- Выход: JSON-массив RatingDto

GET /api/ratings/{id}
- Описание: Получить рейтинг по ID
- Вход: id (Long, >0)
- Выход: RatingDto
- Ошибки: 404 если рейтинг не найден

POST /api/ratings
- Описание: Создать новый рейтинг
- Вход: JSON RatingDto (без id)
- Выход: Созданный RatingDto с id

PATCH /api/ratings
- Описание: Обновить рейтинг
- Вход: JSON RatingDto (с id)
- Выход: Обновлённый RatingDto
- Ошибки: 404 если рейтинг не найден

DELETE /api/ratings/{id}
- Описание: Удалить рейтинг по ID
- Вход: id (Long, >0)
- Выход: пустой ответ 200 OK
- Ошибки: 404 если рейтинг не найден

---

4. API Связей Пользователь-Рейтинг (UserRating)

GET /api/users/{userId}/ratings
- Описание: Получить список рейтингов, в которых участвует пользователь
- Вход: userId (Long, >0)
- Выход: JSON-массив RatingDto
- Ошибки: 404 если пользователь не найден

GET /api/ratings/{ratingId}/users
- Описание: Получить список пользователей, участвующих в рейтинге
- Вход: ratingId (Long, >0)
- Выход: JSON-массив UserDto
- Ошибки: 404 если рейтинг не найден

POST /api/users/{userId}/ratings/{ratingId}
- Описание: Добавить пользователя в рейтинг (присоединиться)
- Вход: userId, ratingId (Long, >0)
- Выход: пустой ответ 200 OK
- Ошибки:
    - 404 если пользователь или рейтинг не найден
    - 409 если пользователь уже в рейтинге

DELETE /api/users/{userId}/ratings/{ratingId}
- Описание: Удалить пользователя из рейтинга (покинуть)
- Вход: userId, ratingId (Long, >0)
- Выход: пустой ответ 200 OK
- Ошибки:
    - 404 если связь пользователя и рейтинга не найдена

---

5. DTO Форматы

UserDto:
{
"id": Long,                  // Идентификатор пользователя
"firstName": String,         // Имя (обязательное, макс 50 символов)
"lastName": String,          // Фамилия (обязательное, макс 50 символов)
"description": String,       // Описание (макс 1000 символов, опционально)
"birthDate": Timestamp,      // Дата рождения (должна быть в прошлом, опционально)
"avatar": String,            // URL аватара (макс 255 символов, опционально)
"education": String,         // Образование (макс 255 символов, опционально)
"createdAt": Timestamp       // Дата создания (автоматически)
}

RatingDto:
{
"id": Long,                  // Идентификатор рейтинга
"title": String,             // Заголовок (обязательное, макс 100 символов)
"description": String,       // Описание (макс 500 символов, опционально)
"avatar": String,            // URL аватара (макс 255 символов, опционально)
"createdAt": Timestamp       // Дата создания (автоматически)
}

---

6. Возможные ошибки и исключения

- UserNotFoundException (404) — пользователь не найден
- RatingNotFoundException (404) — рейтинг не найден
- UserAlreadyInRatingException (409) — пользователь уже участвует в рейтинге
- UserRatingNotFoundException (404) — связь пользователь-рейтинг не найдена
- ValidationException (400) — ошибки валидации данных (например, пустое имя, отрицательный ID)
- InternalServerError (500) — непредвиденные ошибки сервера

---

7. Пример ошибок в формате JSON (при валидации):

{
"fieldName": "error message",
"anotherField": "another error message"
}

---

8. Рекомендации для фронтенда

- Всегда проверяйте коды ответа HTTP.
- При 400 отображайте пользователю ошибки валидации.
- При 404 показывайте сообщение о том, что объект не найден.
- При 409 предупреждайте о конфликте (например, пользователь уже в рейтинге).
- Для POST и PATCH отправляйте JSON с обязательными полями согласно DTO.
- Для DELETE ожидайте пустой ответ с HTTP 200.

---

9. Транзакционность

- Удаление пользователей и рейтингов происходит в транзакции с удалением связанных записей (UserRating).
- Ошибки при удалении связаны с ограничениями целостности данных обрабатываются на уровне сервиса.

---

Документ подготовлен для удобства взаимодействия фронтенда с бекендом.

Если нужны примеры запросов или помощь — обращайтесь.
